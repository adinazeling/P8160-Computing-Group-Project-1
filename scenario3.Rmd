---
title: "Scenario 3: Non-parametric Cox Model"
author: "Adina Zhang"
date: "February 7, 2020"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(survival)
source("./sim.R")
```

```{r, message = FALSE, warning = FALSE}
# Set up coefficient vectors
N = 1000
exp_beta = rep(NA, N)
weibull_beta = rep(NA, N)
cox_beta = rep(NA, N)

for (i in 1:N) {
  # Generate simulated data
  data = generate_data(N = 500, beta = 6, distribution = "cox", 
                       lambda = 3, gamma = 3, alpha = 2)
  
  # Fit three survival distributions
  fit.exponential = survreg(Surv(data$time) ~ data$x, dist = "exponential") 
  fit.weibull = survreg(Surv(data$time) ~ data$x, dist = "weibull")
  fit.cox = coxph(Surv(data$time) ~ data$x) 
  
  # Save beta coefficients 
  exp_beta[i] = -fit.exponential$coefficients[-1]
  weibull_beta[i] = -fit.weibull$coefficients[-1] / fit.weibull$scale
  cox_beta[i] = fit.cox$coefficients[1]
  
}
```


